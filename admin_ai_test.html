<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin AI Test Interface</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #1976d2, #42a5f5);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .content {
            padding: 30px;
        }
        
        .test-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 5px solid #1976d2;
        }
        
        .test-section h3 {
            color: #1976d2;
            margin-bottom: 15px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
        }
        
        .test-section h3::before {
            content: "🧪";
            margin-left: 10px;
        }
        
        .questions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .category-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border: 2px solid #e3f2fd;
            transition: all 0.3s ease;
        }
        
        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.15);
            border-color: #1976d2;
        }
        
        .category-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .category-icon {
            font-size: 1.5rem;
            margin-left: 10px;
        }
        
        .category-title {
            color: #1976d2;
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        .question-list {
            list-style: none;
        }
        
        .question-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid #e9ecef;
        }
        
        .question-item:hover {
            background: #e3f2fd;
            border-color: #1976d2;
            transform: translateX(-5px);
        }
        
        .question-item:last-child {
            margin-bottom: 0;
        }
        
        .test-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .test-btn {
            background: #1976d2;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .test-btn:hover {
            background: #1565c0;
            transform: translateY(-2px);
        }
        
        .test-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .input-section {
            margin-bottom: 20px;
        }
        
        .input-section label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: bold;
        }
        
        .input-section textarea {
            width: 100%;
            height: 100px;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-family: inherit;
            font-size: 1rem;
            resize: vertical;
        }
        
        .input-section textarea:focus {
            outline: none;
            border-color: #1976d2;
        }
        
        .response-section {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            min-height: 200px;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            overflow-y: auto;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #1976d2;
        }
        
        .loading.show {
            display: block;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #1976d2;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .status {
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            font-weight: bold;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .info-box {
            background: #e3f2fd;
            border: 1px solid #bbdefb;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        
        .info-box h4 {
            color: #1976d2;
            margin-bottom: 10px;
        }
        
        .info-box ul {
            margin-right: 20px;
        }
        
        .info-box li {
            margin-bottom: 5px;
        }
        
        .chat-container {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            height: 400px;
            display: flex;
            flex-direction: column;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }
        
        .message {
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
        }
        
        .message.user {
            justify-content: flex-end;
        }
        
        .message-content {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: 18px;
            word-wrap: break-word;
        }
        
        .message.user .message-content {
            background: #1976d2;
            color: white;
            border-bottom-right-radius: 4px;
        }
        
        .message.ai .message-content {
            background: #f1f3f4;
            color: #333;
            border-bottom-left-radius: 4px;
        }
        
        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            margin: 0 8px;
        }
        
        .message.user .message-avatar {
            background: #1976d2;
            color: white;
        }
        
        .message.ai .message-avatar {
            background: #f1f3f4;
            color: #333;
        }
        
        .chat-input {
            display: flex;
            padding: 15px;
            border-top: 1px solid #e0e0e0;
        }
        
        .chat-input input {
            flex: 1;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 20px;
            margin-left: 10px;
            font-size: 1rem;
        }
        
        .chat-input input:focus {
            outline: none;
            border-color: #1976d2;
        }
        
        .chat-input button {
            background: #1976d2;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 1rem;
        }
        
        .chat-input button:hover {
            background: #1565c0;
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .content {
                padding: 20px;
            }
            
            .questions-grid {
                grid-template-columns: 1fr;
            }
            
            .test-buttons {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🤖 Admin AI Test Interface</h1>
            <p>رابط تست تعاملی برای سیستم Admin AI</p>
        </div>
        
        <div class="content">
            <div class="info-box">
                <h4>📋 راهنمای استفاده:</h4>
                <ul>
                    <li>روی سوالات پیشنهادی کلیک کنید تا مستقیماً ارسال شوند</li>
                    <li>از چت تعاملی برای گفتگو با AI استفاده کنید</li>
                    <li>سوالات سفارشی خود را در کادر بنویسید</li>
                    <li>پاسخ‌ها در قسمت چت نمایش داده می‌شوند</li>
                </ul>
            </div>
            
            <div class="test-section">
                <h3>سوالات پیشنهادی</h3>
                <div class="questions-grid" id="questionsGrid">
                    <!-- سوالات پیشنهادی اینجا لود می‌شوند -->
                </div>
            </div>
            
            <div class="test-section">
                <h3>💬 چت تعاملی</h3>
                <div class="chat-container">
                    <div class="chat-messages" id="chatMessages">
                        <div class="message ai">
                            <div class="message-avatar">🤖</div>
                            <div class="message-content">
                                سلام! من Admin AI هستم. چطور می‌تونم کمکتون کنم؟
                            </div>
                        </div>
                    </div>
                    <div class="chat-input">
                        <input type="text" id="chatInput" placeholder="سوال خود را بنویسید..." onkeypress="handleChatKeyPress(event)">
                        <button onclick="sendChatMessage()">ارسال</button>
                    </div>
                </div>
            </div>
            
            <div class="test-section">
                <h3>✍️ سوال سفارشی</h3>
                <div class="input-section">
                    <label for="customQuestion">سوال خود را بنویسید:</label>
                    <textarea id="customQuestion" placeholder="مثال: بهترین محصولات فروش ماه گذشته کدام‌ها بودند؟"></textarea>
                </div>
                <button class="test-btn" onclick="runCustomTest()">ارسال سوال</button>
            </div>
            
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>در حال پردازش...</p>
            </div>
            
            <div id="status"></div>
        </div>
    </div>

    <script>
        // داده‌های سوالات پیشنهادی
        const questionsData = {
            "questions": [
                {
                    "category": "تحلیل فروش",
                    "icon": "📈",
                    "items": [
                        "کارمزد و فروش ده روز گذشته چقدر بوده و چند درصد فروش کارمزد بوده؟",
                        "در کدام زیر دسته سطح سوم بیشترین رشد فروش را در ۹ ماه گذشته داشته‌ایم؟",
                        "مقایسه فروش ماه جاری با ماه قبل چگونه است؟",
                        "پرفروش‌ترین محصولات در ماه گذشته کدام بوده‌اند؟",
                        "روند فروش روزانه در ماه جاری چگونه است؟"
                    ]
                },
                {
                    "category": "تحلیل مشتریان",
                    "icon": "👥",
                    "items": [
                        "درصد مشتریان بازگشتی (ریترن) در هر ماه چقدر بوده است؟",
                        "تعداد مشتریان جدید و بازگشتی در هر ماه چقدر بوده است؟",
                        "میانگین خرید هر مشتری در ماه چقدر است؟",
                        "وفادارترین مشتریان ما چه کسانی هستند؟",
                        "توزیع جغرافیایی مشتریان ما چگونه است؟"
                    ]
                },
                {
                    "category": "مدیریت محصولات",
                    "icon": "📦",
                    "items": [
                        "کدام محصولات پربازدید در حال حاضر ناموجود هستند؟",
                        "محصولات با موجودی کم کدام هستند؟",
                        "کدام محصولات بیشترین حاشیه سود را دارند؟",
                        "محصولات با بیشترین نرخ خرید مجدد کاربر کدام هستند؟",
                        "کدام محصولات نیاز به بروزرسانی قیمت دارند؟"
                    ]
                },
                {
                    "category": "کیفیت خدمات",
                    "icon": "⭐",
                    "items": [
                        "نرخ کنسلی ماهیانه سفارش‌ها در ده ماه گذشته چقدر بوده است؟",
                        "میانگین زمان ارسال سفارش‌های من چقدر بوده است؟",
                        "نرخ رضایت مشتریان در ماه‌های اخیر چگونه بوده است؟",
                        "بیشترین دلایل مرجوعی محصولات چه بوده است؟",
                        "وضعیت پاسخگویی به پیام‌های مشتریان چگونه است؟"
                    ]
                }
            ]
        };

        // متغیرهای سراسری
        let currentTest = null;
        let chatHistory = [];

        // تابع لود کردن سوالات پیشنهادی
        function loadSuggestedQuestions() {
            const grid = document.getElementById('questionsGrid');
            grid.innerHTML = '';

            questionsData.questions.forEach(category => {
                const categoryCard = document.createElement('div');
                categoryCard.className = 'category-card';
                
                categoryCard.innerHTML = `
                    <div class="category-header">
                        <div class="category-icon">${category.icon}</div>
                        <div class="category-title">${category.category}</div>
                    </div>
                    <ul class="question-list">
                        ${category.items.map(question => `
                            <li class="question-item" onclick="sendQuestion('${question}')">
                                ${question}
                            </li>
                        `).join('')}
                    </ul>
                `;
                
                grid.appendChild(categoryCard);
            });
        }

        // تابع ارسال سوال
        function sendQuestion(question) {
            addChatMessage(question, 'user');
            processQuestion(question);
        }

        // تابع اضافه کردن پیام به چت
        function addChatMessage(message, sender) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            const avatar = sender === 'user' ? '👤' : '🤖';
            
            messageDiv.innerHTML = `
                <div class="message-avatar">${avatar}</div>
                <div class="message-content">${message}</div>
            `;
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            // ذخیره در تاریخچه
            chatHistory.push({ sender, message, timestamp: new Date() });
        }

        // تابع پردازش سوال
        function processQuestion(question) {
            showLoading(true);
            
            // شبیه‌سازی پردازش
            setTimeout(() => {
                const response = generateResponse(question);
                addChatMessage(response, 'ai');
                showLoading(false);
            }, 1500 + Math.random() * 1000);
        }

        // تابع تولید پاسخ
        function generateResponse(question) {
            const lowerQuestion = question.toLowerCase();
            
            // پاسخ‌های از پیش تعریف شده
            const responses = {
                'کارمزد و فروش': `📊 گزارش کارمزد و فروش ده روز گذشته:

💰 کل فروش: 1,250,000,000 تومان
💸 کارمزد: 125,000,000 تومان (10%)
📈 درصد کارمزد از کل فروش: 10%

📅 تفکیک روزانه:
• روز 1: 120M فروش، 12M کارمزد
• روز 2: 115M فروش، 11.5M کارمزد
• روز 3: 130M فروش، 13M کارمزد
• ... و غیره

🎯 تحلیل: کارمزد در محدوده استاندارد 8-12% قرار دارد.`,

                'مقایسه فروش': `📈 مقایسه فروش ماه جاری با ماه قبل:

📊 ماه جاری: 3,450,000,000 تومان
📊 ماه قبل: 2,980,000,000 تومان
📈 رشد: +15.8% (470M تومان)

🏆 دسته‌بندی‌های برتر:
1. الکترونیک: +25% رشد
2. پوشاک: +12% رشد
3. کتاب: +8% رشد

📅 روند هفتگی:
• هفته 1: 850M
• هفته 2: 920M
• هفته 3: 880M
• هفته 4: 800M (پیش‌بینی)

🎯 نتیجه: رشد مثبت و پایدار در تمام دسته‌ها`,

                'پرفروش‌ترین محصولات': `🏆 پرفروش‌ترین محصولات ماه گذشته:

1. 📱 iPhone 15 Pro - 156 فروش - 5.4M تومان
2. 💻 Dell XPS 13 - 89 فروش - 4.0M تومان
3. 📱 Samsung Galaxy S24 - 134 فروش - 3.8M تومان
4. 🎧 AirPods Pro - 245 فروش - 2.9M تومان
5. ⌚ Apple Watch - 98 فروش - 1.2M تومان

📊 آمار کلی:
• کل فروش: 17.3M تومان
• میانگین قیمت: 346,000 تومان
• تعداد کل فروش: 722 عدد

📈 روند: رشد 15% نسبت به ماه قبل`,

                'محصولات ناموجود': `⚠️ محصولات پربازدید ناموجود:

1. 📱 iPhone 15 Pro Max (256GB) - 89 بازدید/روز
2. 💻 MacBook Air M2 - 67 بازدید/روز
3. 🎧 Sony WH-1000XM5 - 45 بازدید/روز
4. 📱 Samsung Galaxy S24 Ultra - 34 بازدید/روز
5. ⌚ Apple Watch Series 9 - 28 بازدید/روز

📊 آمار:
• کل محصولات ناموجود: 23 عدد
• میانگین بازدید روزانه: 52.6
• تخمین فروش از دست رفته: 2.1M تومان/روز

🎯 توصیه: افزایش موجودی این محصولات در اولویت است.`,

                'نرخ رضایت': `⭐ نرخ رضایت مشتریان ماه‌های اخیر:

📊 آمار کلی:
• میانگین رضایت: 4.2/5 (84%)
• تعداد نظرات: 1,247
• رضایت مثبت: 1,047 (84%)
• رضایت منفی: 200 (16%)

📅 روند ماهانه:
• فروردین: 4.1/5
• اردیبهشت: 4.2/5
• خرداد: 4.3/5
• تیر: 4.2/5

🏆 عوامل رضایت:
1. کیفیت محصولات (4.4/5)
2. سرعت ارسال (4.1/5)
3. پشتیبانی (4.0/5)
4. قیمت (3.9/5)

🎯 بهبود: تمرکز بر بهبود قیمت‌گذاری و پشتیبانی`
            };

            // تشخیص نوع سوال و تولید پاسخ مناسب
            for (const [key, response] of Object.entries(responses)) {
                if (lowerQuestion.includes(key.toLowerCase())) {
                    return response;
                }
            }

            // پاسخ عمومی
            return `🤖 پاسخ به سوال شما:

"${question}"

📝 تحلیل سوال:
این سوال در دسته‌بندی ${getQuestionCategory(question)} قرار می‌گیرد.

💡 پاسخ پیشنهادی:
بر اساس داده‌های موجود در سیستم، پاسخ مناسب برای سوال شما این است که...

🔍 اطلاعات تکمیلی:
• زمان پردازش: ${(1.5 + Math.random()).toFixed(1)} ثانیه
• دقت پاسخ: ${85 + Math.floor(Math.random() * 15)}%
• منابع استفاده شده: ${2 + Math.floor(Math.random() * 4)} فایل داده

آیا پاسخ شما را راضی کرد؟ می‌توانید سوالات بیشتری بپرسید.`;
        }

        // تابع تشخیص دسته‌بندی سوال
        function getQuestionCategory(question) {
            const lowerQuestion = question.toLowerCase();
            
            if (lowerQuestion.includes('فروش') || lowerQuestion.includes('کارمزد') || lowerQuestion.includes('درآمد')) {
                return 'تحلیل فروش';
            } else if (lowerQuestion.includes('مشتری') || lowerQuestion.includes('ریترن') || lowerQuestion.includes('وفادار')) {
                return 'تحلیل مشتریان';
            } else if (lowerQuestion.includes('محصول') || lowerQuestion.includes('موجودی') || lowerQuestion.includes('کاتالوگ')) {
                return 'مدیریت محصولات';
            } else if (lowerQuestion.includes('رضایت') || lowerQuestion.includes('کیفیت') || lowerQuestion.includes('ارسال')) {
                return 'کیفیت خدمات';
            } else {
                return 'عمومی';
            }
        }

        // تابع ارسال پیام چت
        function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (message) {
                sendQuestion(message);
                input.value = '';
            }
        }

        // تابع کلید Enter در چت
        function handleChatKeyPress(event) {
            if (event.key === 'Enter') {
                sendChatMessage();
            }
        }

        // تابع اجرای تست سفارشی
        function runCustomTest() {
            const question = document.getElementById('customQuestion').value.trim();
            
            if (!question) {
                showStatus('لطفاً سوالی بنویسید!', 'error');
                return;
            }
            
            sendQuestion(question);
            document.getElementById('customQuestion').value = '';
        }

        // تابع نمایش loading
        function showLoading(show) {
            const loading = document.getElementById('loading');
            if (show) {
                loading.classList.add('show');
            } else {
                loading.classList.remove('show');
            }
        }

        // تابع نمایش وضعیت
        function showStatus(message, type) {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
            
            setTimeout(() => {
                statusDiv.innerHTML = '';
            }, 5000);
        }

        // تنظیمات اولیه
        document.addEventListener('DOMContentLoaded', function() {
            loadSuggestedQuestions();
            showStatus('رابط تست آماده است!', 'success');
        });

        // کلید Enter برای ارسال سوال سفارشی
        document.getElementById('customQuestion').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && e.ctrlKey) {
                runCustomTest();
            }
        });
    </script>
</body>
</html> 